<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Towel Shop Color Palette Explorer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Warm Neutral Comfort -->
    <!-- Application Structure Plan: Designed a tab-based single-page application. The user's report requested "a few" palettes. This structure allows direct comparison. The main interaction is clicking a tab (e.g., "Warm Neutral," "Earthy Embrace") which dynamically updates the entire content area. This area includes: 1) A visual swatch, 2) A rationale, 3) A table with specific HEX codes (addressing user's "missing data" feedback), and 4) A live preview mockup of a product card. This provides instant, actionable feedback and directly maps to the user's goal of *deciding* on a palette. -->
    <!-- Visualization & Content Choices: Report Info: "Warm, welcoming, home, comfort" color palettes. Goal: Present, compare, and demonstrate palettes. Viz/Presentation: 1) HTML/CSS Swatches: (Inform) Simple, clear color blocks. 2) HTML Table: (Inform) To provide specific HEX codes and roles, directly addressing user need for "necessary information." 3) Dynamic HTML/CSS Mockup: (Interact/Demo) A "product card" preview dynamically styled with JS. This is the key interaction, allowing the user to *see* the palette in a simulated e-commerce context. Justification: This structure is more useful than a static report, letting the user test and feel the palettes. Library: Vanilla JS for all state and DOM manipulation. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        .palette-tab.active {
            border-color: var(--color-accent);
            background-color: var(--color-accent);
            color: white;
        }
        .palette-tab {
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }
        .preview-card, .preview-button, .palette-swatch {
            transition: all 0.3s ease;
        }
        
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-left-color: var(--color-accent);
            animation: spin 1s ease infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-[#F7F3EE] text-[#4E443F]">

    <div class="container mx-auto p-4 md:p-8 max-w-6xl">
        
        <header class="text-center mb-8 md:mb-12">
            <h1 class="text-3xl md:text-4xl font-bold mb-2">Towel Shop Color Palette Explorer</h1>
            <p class="text-lg md:text-xl" id="page-subtitle">Exploring palettes that feel warm, welcoming, and comfortable.</p>
        </header>

        <nav class="flex flex-wrap justify-center gap-2 md:gap-4 mb-8 md:mb-12" id="palette-navigation">
            <button class="palette-tab text-sm md:text-base font-medium py-2 px-4 rounded-full shadow-sm" data-palette-key="neutral">
                Warm Neutral Comfort
            </button>
            <button class="palette-tab text-sm md:text-base font-medium py-2 px-4 rounded-full shadow-sm" data-palette-key="earthy">
                Earthy Embrace
            </button>
            <button class="palette-tab text-sm md:text-base font-medium py-2 px-4 rounded-full shadow-sm" data-palette-key="sunrise">
                Soft Sunrise
            </button>
            <button class="palette-tab text-sm md:text-base font-medium py-2 px-4 rounded-full shadow-sm" data-palette-key="cream">
                Creamy Cashmere
            </button>
            <button class="palette-tab text-sm md:text-base font-medium py-2 px-4 rounded-full shadow-sm" data-palette-key="sunlit">
                Sunlit Linen
            </button>
        </nav>

        <main id="palette-display" class="bg-transparent rounded-lg">
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12">

                <div>
                    <h2 id="palette-name" class="text-2xl md:text-3xl font-bold mb-3"></h2>
                    <p id="palette-rationale" class="text-base md:text-lg mb-6"></p>

                    <div id="palette-visual" class="flex h-20 md:h-24 rounded-lg overflow-hidden shadow mb-6">
                    </div>

                    <h3 class="text-xl md:text-2xl font-bold mb-4">Color Details</h3>
                    <div class="overflow-x-auto rounded-lg shadow-md">
                        <table id="palette-table" class="w-full min-w-full text-left">
                            <thead class="border-b">
                                <tr>
                                    <th class="p-3 md:p-4 text-sm font-semibold uppercase tracking-wider">Role</th>
                                    <th class="p-3 md:p-4 text-sm font-semibold uppercase tracking-wider">Hex Code</th>
                                    <th class="p-3 md:p-4 text-sm font-semibold uppercase tracking-wider">Preview</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div>
                    <h3 class="text-xl md:text-2xl font-bold mb-4">Live Preview</h3>
                    <p class="text-base mb-4">See how this palette looks on a sample product card. The entire page background and text have also updated.</p>
                    
                    <div class="mb-4">
                        <button id="gemini-generate-btn" class="preview-button w-full py-2 px-4 rounded-lg font-bold text-white shadow-md transition-all duration-300">
                            âœ¨ Suggest Product Details
                        </button>
                        <div id="gemini-loading" class="hidden flex justify-center items-center p-4">
                            <div class="spinner"></div>
                            <span class="ml-3 font-medium" style="color: var(--color-text);">Generating...</span>
                        </div>
                    </div>

                    <div id="preview-card-container" class="p-6 rounded-lg" style="transition: background-color 0.3s ease;">
                        <div id="preview-card" class="preview-card max-w-sm mx-auto rounded-xl shadow-lg overflow-hidden">
                            <img src="https://placehold.co/600x400/EFEAE4/4E443F?text=Cozy+Towel" alt="Placeholder image of a towel" class="w-full h-48 object-cover" id="preview-image">
                            <div class="p-6">
                                <h4 id="preview-title" class="preview-text text-xl font-bold mb-2">Plush Cotton Towel</h4>
                                <p id="preview-text" class="preview-text text-base mb-4">Incredibly soft and absorbent, this towel brings spa-like comfort to your home.</p>
                                <button id="preview-button" class="preview-button w-full py-2 px-4 rounded-lg font-bold text-white shadow-md">
                                    Add to Cart
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <script>
        const palettes = {
            'neutral': {
                name: 'Warm Neutral Comfort',
                rationale: 'This palette is the essence of "warm and welcoming." It uses soft, creamy beige and taupe, grounded by a dark umber for text. The muted terracotta accent adds a touch of warmth without being overpowering, creating a classic, cozy, and high-end feel.',
                colors: {
                    bg: '#F7F3EE',
                    card: '#EFEAE4',
                    accent: '#D58C6A',
                    text: '#4E443F',
                    accentText: '#FFFFFF',
                    placeholder: 'EFEAE4/4E443F'
                },
                roles: [
                    { role: 'Main Background', hex: '#F7F3EE' },
                    { role: 'Card/Section BG', hex: '#EFEAE4' },
                    { role: 'Button/Accent', hex: '#D58C6A' },
                    { role: 'Primary Text', hex: '#4E443F' }
                ]
            },
            'earthy': {
                name: 'Earthy Embrace',
                rationale: 'Connecting "home" and "comfort" to nature, this palette feels organic and serene. A calm sage green pairs with a rich walnut brown for a grounded, spa-like atmosphere. It feels clean, natural, and reassuring.',
                colors: {
                    bg: '#FCFAF8',
                    card: '#D4D8C4',
                    accent: '#8A6E59',
                    text: '#3C3632',
                    accentText: '#FFFFFF',
                    placeholder: 'D4D8C4/3C3632'
                },
                roles: [
                    { role: 'Main Background', hex: '#FCFAF8' },
                    { role: 'Card/Section BG', hex: '#D4D8C4' },
                    { role: 'Button/Accent', hex: '#8A6E59' },
                    { role: 'Primary Text', hex: '#3C3632' }
                ]
            },
            'sunrise': {
                name: 'Soft Sunrise',
                rationale: 'This palette feels like a literal "warm hug." Soft, dusty peach and rose tones are gentle and inviting. A rich, warm coral accent provides energy, while a soft grey text keeps it modern and readable. It\'s cheerful, comfortable, and very welcoming.',
                colors: {
                    bg: '#FFFBF5',
                    card: '#F9EAE1',
                    accent: '#E8A087',
                    text: '#5A524F',
                    accentText: '#FFFFFF',
                    placeholder: 'F9EAE1/5A524F'
                },
                roles: [
                    { role: 'Main Background', hex: '#FFFBF5' },
                    { role: 'Card/Section BG', hex: '#F9EAE1' },
                    { role: 'Button/Accent', hex: '#E8A087' },
                    { role: 'Primary Text', hex: '#5A524F' }
                ]
            },
            'cream': {
                name: 'Creamy Cashmere',
                rationale: 'This palette is pure, understated luxury. It builds on layers of soft, warm cream and ivory, creating a sophisticated and calming "hug." The buttery yellow accent is gentle and uplifting, perfect for a high-end, minimalist feel.',
                colors: {
                    bg: '#FCFAF6',
                    card: '#F5EFE6',
                    accent: '#E8D5A1',
                    text: '#5D554B',
                    accentText: '#4A4642',
                    placeholder: 'F5EFE6/5D554B'
                },
                roles: [
                    { role: 'Main Background', hex: '#FCFAF6' },
                    { role: 'Card/Section BG', hex: '#F5EFE6' },
                    { role: 'Button/Accent', hex: '#E8D5A1' },
                    { role: 'Primary Text', hex: '#5D554B' }
                ]
            },
            'sunlit': {
                name: 'Sunlit Linen',
                rationale: 'This palette feels like a cheerful, sunny morning. It combines a light, buttery cream with a warmer, muted gold accent. It\'s optimistic, welcoming, and instantly conveys "home and comfort" with a bright, happy energy.',
                colors: {
                    bg: '#FFFDF4',
                    card: '#F3EADF',
                    accent: '#DDAA5E',
                    text: '#4A4642',
                    accentText: '#FFFFFF',
                    placeholder: 'F3EADF/4A4642'
                },
                roles: [
                    { role: 'Main Background', hex: '#FFFDF4' },
                    { role: 'Card/Section BG', hex: '#F3EADF' },
                    { role: 'Button/Accent', hex: '#DDAA5E' },
                    { role: 'Primary Text', hex: '#4A4642' }
                ]
            }
        };

        let currentPaletteKey = 'neutral';

        const dom = {
            body: document.body,
            pageSubtitle: document.getElementById('page-subtitle'),
            nav: document.getElementById('palette-navigation'),
            tabs: document.querySelectorAll('.palette-tab'),
            name: document.getElementById('palette-name'),
            rationale: document.getElementById('palette-rationale'),
            visual: document.getElementById('palette-visual'),
            tableBody: document.getElementById('palette-table').querySelector('tbody'),
            previewCardContainer: document.getElementById('preview-card-container'),
            previewCard: document.getElementById('preview-card'),
            previewImage: document.getElementById('preview-image'),
            previewTitle: document.getElementById('preview-title'),
            previewText: document.getElementById('preview-text'),
            previewButton: document.getElementById('preview-button'),
            geminiButton: document.getElementById('gemini-generate-btn'),
            geminiLoading: document.getElementById('gemini-loading')
        };

        function updatePalette(paletteKey) {
            currentPaletteKey = paletteKey;
            const palette = palettes[paletteKey];
            if (!palette) return;

            const { name, rationale, colors, roles, placeholder } = palette;
            
            document.documentElement.style.setProperty('--color-accent', colors.accent);

            dom.body.style.backgroundColor = colors.bg;
            dom.body.style.color = colors.text;
            dom.pageSubtitle.style.color = colors.text;
            dom.geminiLoading.querySelector('span').style.color = colors.text;

            dom.tabs.forEach(tab => {
                tab.classList.remove('active');
                tab.style.backgroundColor = colors.card;
                tab.style.color = colors.text;
                if (tab.dataset.paletteKey === paletteKey) {
                    tab.classList.add('active');
                    tab.style.backgroundColor = colors.accent;
                    tab.style.color = colors.accentText;
                }
            });

            dom.name.textContent = name;
            dom.rationale.textContent = rationale;
            dom.rationale.style.color = colors.text;

            dom.visual.innerHTML = `
                <div class="palette-swatch w-1/4 h-full" style="background-color: ${colors.bg}"></div>
                <div class="palette-swatch w-1/4 h-full" style="background-color: ${colors.card}"></div>
                <div class="palette-swatch w-1/4 h-full" style="background-color: ${colors.accent}"></div>
                <div class="palette-swatch w-1/4 h-full" style="background-color: ${colors.text}"></div>
            `;

            dom.tableBody.innerHTML = roles.map(color => `
                <tr class="border-b" style="background-color: ${colors.card}; color: ${colors.text}; border-color: ${colors.bg};">
                    <td class="p-3 md:p-4 font-medium">${color.role}</td>
                    <td class="p-3 md:p-4 font-mono">${color.hex}</td>
                    <td class="p-3 md:p-4"><div class="w-6 h-6 rounded-full border" style="background-color: ${color.hex}; border-color: ${colors.text}20;"></div></td>
                </tr>
            `).join('');
            
            dom.tableBody.closest('table').style.backgroundColor = colors.card;
            dom.tableBody.closest('table').querySelector('thead').style.backgroundColor = colors.bg;
            dom.tableBody.closest('table').querySelector('thead').style.color = colors.text;

            dom.previewCardContainer.style.backgroundColor = colors.bg;
            dom.previewCard.style.backgroundColor = colors.card;
            dom.previewTitle.style.color = colors.text;
            dom.previewText.style.color = colors.text;
            dom.previewButton.style.backgroundColor = colors.accent;
            dom.previewButton.style.color = colors.accentText;
            dom.geminiButton.style.backgroundColor = colors.accent;
            dom.geminiButton.style.color = colors.accentText;
            dom.previewImage.src = `https://placehold.co/600x400/${placeholder}?text=Cozy+Towel`;
        }

        document.addEventListener('DOMContentLoaded', () => {
            dom.nav.addEventListener('click', (e) => {
                if (e.target.classList.contains('palette-tab')) {
                    updatePalette(e.target.dataset.paletteKey);
                }
            });
            
            dom.geminiButton.addEventListener('click', handleGeminiGenerate);
            
            updatePalette('neutral');
        });

        async function fetchWithBackoff(url, options, retries = 5, delay = 1000) {
            for (let i = 0; i < retries; i++) {
                try {
                    const response = await fetch(url, options);
                    if (response.ok) return response;
                    if ((response.status === 429 || response.status >= 500) && i < retries - 1) {
                        // Throttling or server error, wait and retry
                        await new Promise(resolve => setTimeout(resolve, delay * Math.pow(2, i)));
                    } else {
                        // Client-side error or final retry, return response to be handled
                        return response;
                    }
                } catch (error) {
                    // Network error
                    if (i === retries - 1) throw error; // Rethrow last error
                    await new Promise(resolve => setTimeout(resolve, delay * Math.pow(2, i)));
                }
            }
            throw new Error('API call failed after all retries.');
        }

        async function callGeminiApi(userQuery) {
            const apiKey = ""; // Per instructions, leave empty.
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

            const responseSchema = {
                type: "OBJECT",
                properties: {
                    productName: { "type": "STRING" },
                    description: { "type": "STRING" }
                },
                required: ["productName", "description"]
            };

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: responseSchema
                }
            };

            const options = {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            };

            const response = await fetchWithBackoff(apiUrl, options);

            if (!response.ok) {
                throw new Error(`API request failed with status ${response.status}`);
            }

            const result = await response.json();
            
            const candidate = result.candidates?.[0];
            if (candidate && candidate.content?.parts?.[0]?.text) {
                const jsonText = candidate.content.parts[0].text;
                return JSON.parse(jsonText);
            } else {
                throw new Error("Invalid response structure from API.");
            }
        }

        async function handleGeminiGenerate() {
            dom.geminiButton.classList.add('hidden');
            dom.geminiLoading.classList.remove('hidden');
            
            // Store default text to revert to on error
            const defaultTitle = "Plush Cotton Towel";
            const defaultText = "Incredibly soft and absorbent, this towel brings spa-like comfort to your home.";

            try {
                const palette = palettes[currentPaletteKey];
                const userQuery = `You are a creative marketing assistant for a luxury towel shop. The current color palette is "${palette.name}". The feeling is: "${palette.rationale}". Based on this, generate a new, catchy product name and a short, evocative product description (about 1-2 sentences) for a plush cotton towel.`;

                const data = await callGeminiApi(userQuery);

                if (data.productName && data.description) {
                    dom.previewTitle.textContent = data.productName;
                    dom.previewText.textContent = data.description;
                } else {
                    // Handle cases where JSON is valid but missing fields
                    dom.previewTitle.textContent = defaultTitle;
                    dom.previewText.textContent = defaultText;
D                }
            } catch (error) {
                console.error("Gemini API call failed:", error);
                // Revert to default text on error
                dom.previewTitle.textContent = defaultTitle;
                dom.previewText.textContent = `Error generating content. ${defaultText}`;
            } finally {
                dom.geminiButton.classList.remove('hidden');
                dom.geminiLoading.classList.add('hidden');
            }
        }

    </script>
</body>
</html>
